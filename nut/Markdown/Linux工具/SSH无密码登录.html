<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SSH无密码登录</title>
<link rel="stylesheet" href="https://stackedit.io/res-min/themes/base.css" />
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body><div class="container"><p>SSH为Secure Shell的缩写，是建立在应用层和传输层基础上的安全协议。SSH是目前较可靠，专为远程登录会话和其他网络服务提供安全性的协议。 <br>
启动SSH服务器后，sshd运行起来并在默认的22端口进行监听，安装完CentOS后sshd并没有运行起来，但防火墙已经默认开放了22端口。所以只需要执行“service sshd start”即可开启sshd服务，如果需要开机自启动，可执行“chkconfig sshd on”。</p>

<h2 id="安全验证">安全验证</h2>

<p>从客户端来看，SSH提供两种级别的安全验证。 <br>
第一种级别（基于口令的安全验证） <br>
只要你知道自己帐号和口令，就可以登录到远程主机。所有传输的数据都会被加密，但是不能保证你正在连接的服务器就是你想连接的服务器。可能会有别的服务器在冒充真正的服务器，也就是受到“中间人”这种方式的攻击。 <br>
第二种级别（基于密钥的安全验证） <br>
需要依靠密钥，也就是你必须为自己创建一对密钥，并把公用密钥放在需要访问的服务器上。如果你要连接到SSH服务器上，客户端软件就会向服务器发出请求，请求用你的密钥进行安全验证。服务器收到请求之后，先在该服务器上你的主目录下寻找你的公用密钥，然后把它和你发送过来的公用密钥进行比较。如果两个密钥一致，服务器就用公用密钥加密“质询”（challenge）并把它发送给客户端软件。客户端软件收到“质询”之后就可以用你的私人密钥解密再把它发送给服务器。 <br>
用这种方式，你必须知道自己密钥的口令。但是，与第一种级别相比，第二种级别不需要在网络上传送口令。 <br>
第二种级别不仅加密所有传送的数据，而且“中间人”这种攻击方式也是不可能的。</p>

<h2 id="口令验证">口令验证</h2>

<p>如果本地端是Linux，可直接执行ssh username@IP。其中username表示的是登录用户名，IP为服务器的IP地址，当然也可以使用主机名、域名来指代IP地址。如果直接执行ssh IP，则会以当前终端的用户名进行登录。 <br>
Windows需要借助软件putty等。</p>



<h2 id="密匙验证">密匙验证</h2>

<p>在客户端生成私钥、公钥</p>

<pre><code># ssh-keygen -t rsa
</code></pre>

<p>-t指定要创建的密钥类型，默认就是rsa了，所以只执行ssh-keygen也是一样的。 <br>
期间会提示你输入你私钥的加密密码。如果需要完全脱离密码，此处可留空，直接回车，否则以后每次连接需要本地解锁。 <br>
期间还会提示你私钥、公钥的保存路径，可直接按回车，则保存在前用户的主目录下的~/.ssh/路径下。 <br>
这两个参数也可以在ssh-keygen的参数里指定，比如</p>

<pre><code># ssh-keygen -t rsa -P ‘password’ -f ~/.ssh/id_rsa
</code></pre>

<p>ssh-keygen代表生成密钥；-t表示指定生成的密钥类型；-P用于提供密语；-f指定生成的密钥文件。 <br>
生成的两个文件id_rsa与id_rsa.pub分别是私钥与公钥。 <br>
接下来，要把生成的公钥上传到服务器上，同样还是在客户端执行以下的代码。</p>

<pre><code># ssh-copy-id -i ~/.ssh/id_rsa.pub root@192.168.1.1
</code></pre>

<p>其中root可以修改为你想要自动登录的服务器端用户名，192.168.1.1修改为你的服务器的主机名或IP地址。 <br>
它所做的工作其实是将id_rsa.pub的内容添加到服务器的~/.ssh/authorized_keys文件中，这也可以通过手工来做，但要注意权限：</p>

<pre><code>.ssh目录的权限要设置为700，authorized_keys的权限要设置为600！
</code></pre>
</html>