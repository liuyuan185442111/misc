<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Java Web入门之Listener要点</title>
<link rel="stylesheet" href="https://stackedit.io/res-min/themes/base.css" />
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body><div class="container"><p>Servlet监听器用来给Web应用增加事件处理机制，以便更好地监视和控制Web应用的状态变化，从而在后台调用相应处理程序。 <br>
在一个web应用程序的整个运行周期内，web容器会创建和销毁三个重要的对象，ServletContext，HttpSession，ServletRequest，可以对它们设置属性信息，它们是监听器的监听对象。 <br>
Servlet规范中为每种事件监听器都定义了相应的接口，在编写事件监听器程序时只需实现这些接口就可以了。</p>

<table><tbody><tr><td><b>监听对象</b></td>
<td><b>接口</b></td>
<td><b>监听事件</b></td></tr>
<tr><td rowspan="2">ServletRequest</td>
<td>ServletRequestListener</td>
<td>ServletRequestEvent</td></tr>
<tr><td>ServletRequestAttributeListener</td>
<td>ServletRequestAttributeEvent</td></tr>
<tr><td rowspan="4">HttpSession</td>
<td>HttpSessionListener</td>
<td rowspan="2">HttpSessionEvent</td></tr>
<tr><td>HttpSessionActivationListener</td></tr>
<tr><td>HttpSessionAttributeListener</td>
<td rowspan="2">HttpSessionBindingEvent</td></tr>
<tr><td>HttpSessionBindingListener</td></tr>
<tr><td rowspan="2">ServletContext</td>
<td>ServletContextListener</td>
<td>ServletContextEvent</td></tr>
<tr><td>ServletContextAttributeListener</td>
<td>ServletContextAttributeEvent</td></tr></tbody></table>



<h2 id="监听器类型">监听器类型</h2>



<h3 id="按监听的对象划分">按监听的对象划分</h3>

<p>1.用于监听应用程序环境对象（ServletContext）的事件监听器 <br>
2.用于监听用户会话对象（HttpSession）的事件监听器 <br>
3.用于监听请求消息对象（ServletRequest）的事件监听器</p>

<h3 id="按监听的事件类项划分">按监听的事件类项划分</h3>

<p>1.生命周期监听器，用于监听域对象自身的创建和销毁的事件监听器 <br>
包括ServletContextListener，ServletRequestListener，  HttpSessionListener <br>
2.属性操作监听器，用于监听域对象中的属性的增加和删除的事件监听器 <br>
包括ServletContextAttributeListener，ServletRequestAttributeListener， HttpSessionAttributeListener <br>
3.会话属性类监听器，用于监听绑定到HttpSession域中的某个对象的状态的事件监听器 <br>
包括HttpSessionBindingListener，HttpSessionActivationListener <br>
前两种监听器都要在web.xml中进行声明，声明形式如下：</p>

<pre class="prettyprint"><code class="language-xml hljs "><span class="hljs-tag">&lt;<span class="hljs-title">web-app</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">listener</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">listener-class</span>&gt;</span>类的全限定名<span class="hljs-tag">&lt;/<span class="hljs-title">listener-class</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">listener</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">web-app</span>&gt;</span></code></pre>

<p>第三种类型的监听器不用在web.xml中进行声明。</p>



<h2 id="部署">部署</h2>

<p>监听器的部署在web.xml文件中配置，它的位置应该在Filter的后面Servlet的前面。 <br>
一个web.xml可以注册多个servlet事件监听器，web服务器按照它们在web.xml中注册顺序来加载和注册这些servlet事件监听器。</p>



<h2 id="部分接口">部分接口</h2>

<p>ServletContextListener接口方法有： <br>
void contextInitialized(ServletContextEvent sce)：通知正在接受的对象，应用程序已经被加载及初始化 <br>
void contextDestroyed(ServletContextEvent sce)：通知正在接受的对象，应用程序已经被销毁</p>

<p>ServletRequestListener接口方法有： <br>
requestInitialized (ServletRequestEvent sre)：通知当前对象，请求已经被加载及初始化 <br>
requestDestroyed (ServletRequestEvent sre)：通知当前对象，请求已经被消除</p>

<p>HttpSessionListener接口方法有： <br>
sessionCreated(HttpSessionEvent e)：当创建一个Session时，调用该方法 <br>
sessionDestroyed(HttpSessionEvent e)：当销毁一个Session时，调用该方法</p>

<p>HttpSessionAttributeListener接口的方法有： <br>
attributeAdded(HttpSessionBindingEvent se)：当在Session增加一个属性时，调用此方法 <br>
attributeRemoved(HttpSessionBindingEvent se)：当在Session删除一个属性时，调用此方法 <br>
attributeReplaced(HttpSessionBindingEvent se)：在Session属性被重新设置时，调用此方法</p>

<p>HttpSessionBindingEvent当中的方法： <br>
HttpSession getSession()：可以获取Session对象 <br>
java.lang.String getName：返回Session增加、删除或者替换的属性名称 <br>
java.lang.Object getValue()：返回Session增加、删除或者替换的属性的值</p>



<h2 id="简单测试">简单测试</h2>

<pre class="prettyprint"><code class="language-java hljs "><span class="hljs-keyword">package</span> advance;

<span class="hljs-keyword">import</span> javax.servlet.ServletContext;
<span class="hljs-keyword">import</span> javax.servlet.ServletContextListener;
<span class="hljs-keyword">import</span> javax.servlet.ServletContextEvent;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Listener</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ServletContextListener</span>
{</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">contextInitialized</span>(ServletContextEvent sce)
    {
        System.out.println(<span class="hljs-string">"contextInitialized"</span>);
    }
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">contextDestroyed</span>(ServletContextEvent sce)
    {
        System.out.println(<span class="hljs-string">"contextDestroyed"</span>);
    }
}</code></pre>

<p><img src="http://img.blog.csdn.net/20150502165954777" alt="结果" title=""></p>



<h2 id="参考">参考</h2>

<p>jsp中监听器的使用 <br>
 <a href="http://blog.csdn.net/wxwzy738/article/details/8615244">http://blog.csdn.net/wxwzy738/article/details/8615244</a></p></div></body>
</html>